delete from etpl;

INSERT INTO etpl (providerid,officialname,cipcode,approvingagencyid,otheragency,submittedtowib,tuition,fees,booksmaterialscost,suppliestoolscost,othercosts,totalcost,prerequisites,wiaeligible,leadtodegree,degreeawarded,leadtolicense,licenseawarded,leadtoindustrycredential,industrycredential,financialaid,description,credit,totalclockhours,calendarlengthid,featuresdescription,wibcomment,statecomment,submitted,approved,contactname,contactphone,contactphoneextension,programid,statusname,name,schoolidentificationnumber,street1,street2,city,state,zip,county,mstreet1,mstreet2,mcity,mstate,mzip,contactfirstname,contactlastname,contacttitle,phone,phoneextension,fax,website,email,licensingagencyid,typeid,nongovapproval,certapprovalexp,customized,distancelearning,speakspanish,otherlanguages,languages,careerassist,onestopcareer,personalassist,accessajbatb,childcare,assistobtainingchildcare,eveningcourses,accessfordisabled,busroute1,busroute2,trnroute1,trnroute2,providerwibcomment,providerstatecomment,dtsubmitted,providerstatusname,standardized_name,standardized_name_1,standardized_description,standardized_featuresdescription,mentions_wioa,default_job_search_duration,mentioned_job_search_duration) values ('123','Tree Identification Class','123456','1',null,'16','3000','35','0','0','0','3035','High School Diploma/G.E.D. or Ability To Benefit','1',null,null,null,null,null,null,'1','This program is designed for clients who are interested in learning skills necessary for todays modern tree identification jobs. Students will learn to distinguish types of trees by their leaves and bark and seeds.',null,'636','6','"Instruction is student centered and relevant to workforce needs.  Each learner is viewed and valued individually.  Individualized Education Plans are developed which includes a ""thinking"" curriculum and applied learning.  Job Placement Assistance available for all Graduates.  Financial Aid available for those who qualify.  Full and part-time day and evening classes available.  Portfolios suggested for graduates.  Courses can be customized to meet your needs.  MICROSOFT OFFICE 2000 available."',null,null,'1/1/2000 12:00:00 AM','2','Cynthia Wells','5551234567','14','1','Approved','Vineland Public Schools Adult Education Program','216000332000','48 W. Landis Ave.',null,'Vineland','NJ','08360','Cumberland','48 W. Landis Ave.',null,'Vineland','NJ','08360','Gloria','Kucher','Principal','8567946943','8950','8567941120','www.vineland.org/adulted','gkucher@vineland.org','18','2',null,null,'2','2','1','2',null,'1','1','2','1','2','1','1','1','NJT #553','NJT #408','None Available',null,null,'3/28/2014 Maile Returned as undeliverable. J Voj','1/1/2002 12:00:00 AM','Approved','Standardized Tree Identification Class','Standardized Vineland Public Schools','Standardized This program is designed for clients who are interested in learning skills necessary for todays modern tree identification jobs. Students will learn to distinguish types of trees by their leaves and bark and seeds.','standardized_featuresdescription','FALSE','0',null);
INSERT INTO etpl (providerid,officialname,cipcode,approvingagencyid,otheragency,submittedtowib,tuition,fees,booksmaterialscost,suppliestoolscost,othercosts,totalcost,prerequisites,wiaeligible,leadtodegree,degreeawarded,leadtolicense,licenseawarded,leadtoindustrycredential,industrycredential,financialaid,description,credit,totalclockhours,calendarlengthid,featuresdescription,wibcomment,statecomment,submitted,approved,contactname,contactphone,contactphoneextension,programid,statusname,name,schoolidentificationnumber,street1,street2,city,state,zip,county,mstreet1,mstreet2,mcity,mstate,mzip,contactfirstname,contactlastname,contacttitle,phone,phoneextension,fax,website,email,licensingagencyid,typeid,nongovapproval,certapprovalexp,customized,distancelearning,speakspanish,otherlanguages,languages,careerassist,onestopcareer,personalassist,accessajbatb,childcare,assistobtainingchildcare,eveningcourses,accessfordisabled,busroute1,busroute2,trnroute1,trnroute2,providerwibcomment,providerstatecomment,dtsubmitted,providerstatusname,standardized_name,standardized_name_1,standardized_description,standardized_featuresdescription,mentions_wioa,default_job_search_duration,mentioned_job_search_duration) values ('123','Tree Identification Class Level 2','123456','1',null,'16','3000','35','0','0','0','3035','High School Diploma/G.E.D. or Ability To Benefit','1',null,null,null,null,null,null,'1','This program is designed for clients who are interested in learning skills necessary for todays modern tree identification jobs. Students will learn to distinguish types of trees by their leaves and bark and seeds. This is Tree Level 2. It says the word tree a lot.',null,'636','6','"Instruction is student centered and relevant to workforce needs.  Each learner is viewed and valued individually.  Individualized Education Plans are developed which includes a ""thinking"" curriculum and applied learning.  Job Placement Assistance available for all Graduates.  Financial Aid available for those who qualify.  Full and part-time day and evening classes available.  Portfolios suggested for graduates.  Courses can be customized to meet your needs.  MICROSOFT OFFICE 2000 available."',null,null,'1/1/2000 12:00:00 AM','2','Cynthia Wells','5551234567','14','2','Approved','Vineland Public Schools Adult Education Program','216000332000','48 W. Landis Ave.',null,'Vineland','NJ','08360','Cumberland','48 W. Landis Ave.',null,'Vineland','NJ','08360','Gloria','Kucher','Principal','8567946943','8950','8567941120','www.vineland.org/adulted','gkucher@vineland.org','18','2',null,null,'2','2','1','2',null,'1','1','2','1','2','1','1','1','NJT #553','NJT #408','None Available',null,null,'3/28/2014 Maile Returned as undeliverable. J Voj','1/1/2002 12:00:00 AM','Approved','Standardized Tree Identification Class Level 2','Standardized Vineland Public Schools','Standardized This program is designed for clients who are interested in learning skills necessary for todays modern tree identification jobs. Students will learn to distinguish types of trees by their leaves and bark and seeds. This is Tree Level 2. It says the word tree a lot.','standardized_featuresdescription','FALSE','0',null);
INSERT INTO etpl (providerid,officialname,cipcode,approvingagencyid,otheragency,submittedtowib,tuition,fees,booksmaterialscost,suppliestoolscost,othercosts,totalcost,prerequisites,wiaeligible,leadtodegree,degreeawarded,leadtolicense,licenseawarded,leadtoindustrycredential,industrycredential,financialaid,description,credit,totalclockhours,calendarlengthid,featuresdescription,wibcomment,statecomment,submitted,approved,contactname,contactphone,contactphoneextension,programid,statusname,name,schoolidentificationnumber,street1,street2,city,state,zip,county,mstreet1,mstreet2,mcity,mstate,mzip,contactfirstname,contactlastname,contacttitle,phone,phoneextension,fax,website,email,licensingagencyid,typeid,nongovapproval,certapprovalexp,customized,distancelearning,speakspanish,otherlanguages,languages,careerassist,onestopcareer,personalassist,accessajbatb,childcare,assistobtainingchildcare,eveningcourses,accessfordisabled,busroute1,busroute2,trnroute1,trnroute2,providerwibcomment,providerstatecomment,dtsubmitted,providerstatusname,standardized_name,standardized_name_1,standardized_description,standardized_featuresdescription,mentions_wioa,default_job_search_duration,mentioned_job_search_duration) values ('456','Edible Leaves 101','987654','1',null,'16','1200','35','0','0','0','1235.20','"High School Diploma or G.E.D. or Ability To Benefit, work history"','1',null,null,null,null,null,null,'1','"This program is designed to prepare students for jobs where edible leaf eating is required.  Software includes Microsoft Office including PowerPoint. Prior experience with eating is a must.',null,'310','6','"Instruction is student centered and relevant to workforce needs.  Each learner is viewed and valued individually.  Individualized Education Plans are developed which includes a ""thinking"" curriculum and applied learning.  Job Placement Assistance available for all Graduates.  Financial Aid for those who qualify thru Sallie Mae.  Full and part-time day and evening classes available.  Portfolios suggested for graduates.  Courses can be customized to meet your needs.  MICROSOFT OFFICE 2000 available."',null,null,'1/1/2000 12:00:00 AM','2','Cynthia Wells','5551234567','14','3','Suspend','Trees Are Cool School','1454325','48 W. Landis Ave.',null,'Treeland','NJ','08360','Treeland','48 W. Landis Ave.',null,'Treeland','NJ','08360','Gloria','Kucher','Principal','8567946943','8950','8567941120','www.vineland.org/adulted','gkucher@vineland.org','18','2',null,null,'2','2','1','2',null,'1','1','2','1','2','1','1','1','NJT #553','NJT #408','None Available',null,null,'3/28/2014 Maile Returned as undeliverable. J Voj','1/1/2002 12:00:00 AM','Approved','Standardized Edible Leaves 101','Standardized Trees Are Cool School','Standardized This program is designed to prepare students for jobs where edible leaf eating is required.  Software includes Microsoft Office including PowerPoint. Prior experience with eating is a must.','standardized_featuresdescription','FALSE','0',null);
INSERT INTO etpl (providerid,officialname,cipcode,approvingagencyid,otheragency,submittedtowib,tuition,fees,booksmaterialscost,suppliestoolscost,othercosts,totalcost,prerequisites,wiaeligible,leadtodegree,degreeawarded,leadtolicense,licenseawarded,leadtoindustrycredential,industrycredential,financialaid,description,credit,totalclockhours,calendarlengthid,featuresdescription,wibcomment,statecomment,submitted,approved,contactname,contactphone,contactphoneextension,programid,statusname,name,schoolidentificationnumber,street1,street2,city,state,zip,county,mstreet1,mstreet2,mcity,mstate,mzip,contactfirstname,contactlastname,contacttitle,phone,phoneextension,fax,website,email,licensingagencyid,typeid,nongovapproval,certapprovalexp,customized,distancelearning,speakspanish,otherlanguages,languages,careerassist,onestopcareer,personalassist,accessajbatb,childcare,assistobtainingchildcare,eveningcourses,accessfordisabled,busroute1,busroute2,trnroute1,trnroute2,providerwibcomment,providerstatecomment,dtsubmitted,providerstatusname,standardized_name,standardized_name_1,standardized_description,standardized_featuresdescription,mentions_wioa,default_job_search_duration,mentioned_job_search_duration) values ('789','Mushroom Foraging Certification','121212','1',null,'16','10','35','0','0','0','45','"High School Diploma or G.E.D. or Ability To Benefit, work history"','1',null,null,null,null,null,null,null,'Eat mushrooms; they are good for you. Become a chef to help others eat mushrooms.',null,'310',null,'"Instruction is student centered and relevant to workforce needs.  Each learner is viewed and valued individually.  Individualized Education Plans are developed which includes a ""thinking"" curriculum and applied learning.  Job Placement Assistance available for all Graduates.  Financial Aid for those who qualify thru Sallie Mae.  Full and part-time day and evening classes available.  Portfolios suggested for graduates.  Courses can be customized to meet your needs.  MICROSOFT OFFICE 2000 available."',null,null,'1/1/2000 12:00:00 AM','2','Cynthia Wells','5551234567','14','4','Approved','Wild Central Park Foraging Inc','67875654','48 W. Landis Ave.',null,'Cumberland','NJ','08360','Cumberland','48 W. Landis Ave.',null,'Cumberland','NJ','08360','Gl oria','Kucher','Principal','8567946943','8950','8567941120',null,'gkucher@vineland.org','18','2',null,null,'2','2','1','2',null,'1','1','2','1','2','1','1','1','NJT #553','NJT #408','None Available',null,null,'3/28/2014 Maile Returned as undeliverable. J Voj','1/1/2002 12:00:00 AM','Suspend','Standardized Mushroom Foraging Certification','Standardized Wild Central Park Foraging Inc','Standardized Eat mushrooms; they are good for you. Become a chef to help others eat mushrooms.','standardized_featuresdescription','FALSE','0',null);
INSERT INTO etpl (providerid,officialname,cipcode,approvingagencyid,otheragency,submittedtowib,tuition,fees,booksmaterialscost,suppliestoolscost,othercosts,totalcost,prerequisites,wiaeligible,leadtodegree,degreeawarded,leadtolicense,licenseawarded,leadtoindustrycredential,industrycredential,financialaid,description,credit,totalclockhours,calendarlengthid,featuresdescription,wibcomment,statecomment,submitted,approved,contactname,contactphone,contactphoneextension,programid,statusname,name,schoolidentificationnumber,street1,street2,city,state,zip,county,mstreet1,mstreet2,mcity,mstate,mzip,contactfirstname,contactlastname,contacttitle,phone,phoneextension,fax,website,email,licensingagencyid,typeid,nongovapproval,certapprovalexp,customized,distancelearning,speakspanish,otherlanguages,languages,careerassist,onestopcareer,personalassist,accessajbatb,childcare,assistobtainingchildcare,eveningcourses,accessfordisabled,busroute1,busroute2,trnroute1,trnroute2,providerwibcomment,providerstatecomment,dtsubmitted,providerstatusname,standardized_name,standardized_name_1,standardized_description,standardized_featuresdescription,mentions_wioa,default_job_search_duration,mentioned_job_search_duration) values ('456','Program With No Outcomes','000000','1',null,'16','100','0','0','0','0','100.00','"High School Diploma or G.E.D. or Ability To Benefit, work history"','1',null,null,null,null,null,null,'2','This program is also about trees.',null,'310','6','"Instruction is student centered and relevant to workforce needs.  Each learner is viewed and valued individually.  Individualized Education Plans are developed which includes a ""thinking"" curriculum and applied learning.  Job Placement Assistance available for all Graduates.  Financial Aid for those who qualify thru Sallie Mae.  Full and part-time day and evening classes available.  Portfolios suggested for graduates.  Courses can be customized to meet your needs.  MICROSOFT OFFICE 2000 available."',null,null,'1/1/2000 12:00:00 AM','2','Cynthia Wells','5551234567','14','5','Approved','Trees Are Cool School','1454325','48 W. Landis Ave.',null,'Treeland','NJ','08360','Treeland','48 W. Landis Ave.',null,'Treeland','NJ','08360','Gloria','Kucher','Principal','8567946943','8950','8567941120','www.vineland.org/adulted','gkucher@vineland.org','18','2',null,null,'2','2','1','2',null,'1','1','2','1','2','1','1','1','NJT #553','NJT #408','None Available',null,null,'3/28/2014 Maile Returned as undeliverable. J Voj','1/1/2002 12:00:00 AM','Approved','Standardized Program With No Outcomes','Standardized Trees Are Cool School','Standardized This program is also about trees.','standardized_featuresdescription','FALSE','0',null);
INSERT INTO etpl (providerid,officialname,cipcode,approvingagencyid,otheragency,submittedtowib,tuition,fees,booksmaterialscost,suppliestoolscost,othercosts,totalcost,prerequisites,wiaeligible,leadtodegree,degreeawarded,leadtolicense,licenseawarded,leadtoindustrycredential,industrycredential,financialaid,description,credit,totalclockhours,calendarlengthid,featuresdescription,wibcomment,statecomment,submitted,approved,contactname,contactphone,contactphoneextension,programid,statusname,name,schoolidentificationnumber,street1,street2,city,state,zip,county,mstreet1,mstreet2,mcity,mstate,mzip,contactfirstname,contactlastname,contacttitle,phone,phoneextension,fax,website,email,licensingagencyid,typeid,nongovapproval,certapprovalexp,customized,distancelearning,speakspanish,otherlanguages,languages,careerassist,onestopcareer,personalassist,accessajbatb,childcare,assistobtainingchildcare,eveningcourses,accessfordisabled,busroute1,busroute2,trnroute1,trnroute2,providerwibcomment,providerstatecomment,dtsubmitted,providerstatusname,standardized_name,standardized_name_1,standardized_description,standardized_featuresdescription,mentions_wioa,default_job_search_duration,mentioned_job_search_duration) values ('456','Program With No Description','000000','1',null,'16','100','0','0','0','0','100.00','"High School Diploma or G.E.D. or Ability To Benefit, work history"','1',null,null,null,null,null,null,'2',null,null,'310','6','"Instruction is student centered and relevant to workforce needs.  Each learner is viewed and valued individually.  Individualized Education Plans are developed which includes a ""thinking"" curriculum and applied learning.  Job Placement Assistance available for all Graduates.  Financial Aid for those who qualify thru Sallie Mae.  Full and part-time day and evening classes available.  Portfolios suggested for graduates.  Courses can be customized to meet your needs.  MICROSOFT OFFICE 2000 available."',null,null,'1/1/2000 12:00:00 AM','2','Cynthia Wells','5551234567','14','6','Approved','Trees Are Cool School','1454325','48 W. Landis Ave.',null,'Treeland','NJ','08360','Treeland','48 W. Landis Ave.',null,'Treeland','NJ','08360','Gloria','Kucher','Principal','8567946943','8950','8567941120','www.vineland.org/adulted','gkucher@vineland.org','18','2',null,null,'2','2','1','2',null,'1','1','2','1','2','1','1','1','NJT #553','NJT #408','None Available',null,null,'3/28/2014 Maile Returned as undeliverable. J Voj','1/1/2002 12:00:00 AM','Approved','Standardized Program With No Description','Standardized Trees Are Cool School',null,'standardized_featuresdescription','FALSE','0',null);

delete from programtokens;

insert into programtokens(programid, tokens)
select etpl.programid,
       to_tsvector(coalesce(etpl.standardized_name, etpl.officialname)) ||
       to_tsvector(coalesce(etpl.standardized_description, etpl.description, '')) ||
       to_tsvector(coalesce((string_agg(soccipcrosswalk.soc2018title, ' ')), ''))
from etpl
         left outer join soccipcrosswalk
                         on etpl.cipcode = soccipcrosswalk.cipcode
group by etpl.programid;